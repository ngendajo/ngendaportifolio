<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Engineer Ngendahimana Joseph</title>
        <link rel="stylesheet" href="styles/styles.css">
        <link href="https://fonts.googleapis.com/css?family=Zhi Mang Xing" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    </head>
    <body>
        <div class="main">
            <header>
                <div class="logo">
                    Engineer Ngendahimana Joseph
                </div>
                <div class="titles">
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="contactme.html">Contact me</a></li>
                        <li><a href="profile.html">Profile</a></li>
                    </ul>
                </div>
            </header>
            <div>
                <hr class="bar">
            </div>
            <div class="content">
                <div id="login_div" class="main-div">
                    <h3>Admin Login</h3>
                    <input type="email" placeholder="Email..." id="email_field"/>
                    <input type="password" placeholder="password..." id="password_field"/>
                    <button onclick="login()">Login</button>
                </div>
                <div id="user_div">
                    <div class="admin_view">
                        <div class="comment" >
                            <div id="visitors">
        
                            </div>
                            
                        </div>  
                        <div>
                            <div>
                                <h1><i id="likes">0 </i><span class="post"> Likes</span></h1>
                                <h1><i id="subscr">0 </i> <span class="post1">Subscribes</span></h1>
                            </div>
                            <div>
                                <h1>Add updated article</h1>
                                <p id="error" style="color: red;"></p>
                                <form id="adform" method="POST" autocomplete="off">
                                    <input id="name2" type="text" name="arttitle" placeholder="Enter the Title" required><br>
                                    <textarea name="details" id="message2" placeholder="Enter Details" required></textarea>
                                   <center> <input type="submit" name="title1" value="Post" id="submit2">
                                    <input type="button" name="title1" onclick="logout()" value="Logout" id="submit3">
                                </center>
        
                                </form>
                            </div>
                        </div> 
                    </div> 
                </div>              
                
            </div>
        </div>
        <script src="https://www.gstatic.com/firebasejs/7.21.1/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.21.1/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.21.1/firebase-database.js"></script>
        <script id="mainScript">
             var firebaseConfig = {
                apiKey: "AIzaSyD1QVFIIVtj0F-ZaRVU2O0WPE2YvxrsIjU",
                authDomain: "ngenda-bfdfa.firebaseapp.com",
                databaseURL: "https://ngenda-bfdfa.firebaseio.com",
                projectId: "ngenda-bfdfa",
                storageBucket: "ngenda-bfdfa.appspot.com",
                messagingSenderId: "188708309095",
                appId: "1:188708309095:web:353bdc3955408c84762cc2"
            };
            // Initialize Firebase
            firebase.initializeApp(firebaseConfig);
           
            //......................selection process............................

                
                    database=firebase.database();     
                var ref=database.ref('visitors');
                ref.on('value',gotData,errData);
                

                function gotData(data)
                {
                   var visits=data.val();
                   var keys=Object.keys(visits);
                   document.getElementById('visitors').innerHTML='';
                   for(var i=0;i<keys.length;i++)
                   {
                       var k=keys[i];
                       var names=visits[k].Names;
                       var emailv=visits[k].emailv;
                       var datev=visits[k].datev;
                       var commentv=visits[k].commentv;
                       //console.log(names,emailv,datev,commentv);
                       document.getElementById('visitors').innerHTML+='<h3>'+names+' '+emailv+'</h3><p>'+commentv+'</p>'+'<h4>'+datev+'</h4>';
                   }
                }
                function errData(err)
                {
                    window.alert('error! '+err);
                }


                var refs=database.ref('likes');
                refs.on('value',gotData1,errData1);
                

                function gotData1(data)
                {
                   var visits=data.val();
                   var keys=Object.keys(visits);
                   var likes1=0;
                   for(var i=0;i<keys.length;i++)
                   {
                       var k=keys[i];
                      var likes=visits[k].datev;
                       likes1+=1;
                       console.log(likes,likes1);
                       
                       }
                       document.getElementById('likes').innerHTML=likes1+" ";

                }
                function errData1(err)
                {
                    window.alert('error! '+err);
                }

                var refs1=database.ref('subscr');
                refs1.on('value',gotData2,errData2);
                

                function gotData2(data)
                {
                   var visits=data.val();
                   var keys=Object.keys(visits);
                   var subscr=0;
                   for(var i=0;i<keys.length;i++)
                   {
                       var k=keys[i];
                      var likes=visits[k].datev;
                       subscr+=1;
                       console.log(likes,subscr);
                       
                       }
                       document.getElementById('subscr').innerHTML=subscr+" ";

                }
                function errData2(err)
                {
                    window.alert('error! '+err);
                }
                

            //............................update data............
           /* document.getElementById("update").onclick=function(){
                Ready();
                firebase.database().ref('student/'+rollv).update({
                    NameOfStudent: namev,
                    Section: secv,
                    Gender: genv
                });
            }*/
            //............................delete data............
           /* document.getElementById("delete").onclick=function(){
                Ready();
                firebase.database().ref('student/'+rollv).remove();
            }*/
            
        </script>
        <script src="https://cdn.ckeditor.com/4.15.0/standard/ckeditor.js"></script>
        <script defer src="index.js"></script>
    </body>
</html>