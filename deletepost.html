<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Engineer Ngendahimana Joseph</title>
        <link rel="stylesheet" href="styles/styles.css">
        <link href="https://fonts.googleapis.com/css?family=Zhi Mang Xing" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        
    </head>
    <body>
        <div class="main">
            <header>
                <div class="logo">
                    Engineer Ngendahimana Joseph
                </div>
                <div class="titles">
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="contactme.html">Contact me</a></li>
                        <li><a href="profile.html">Profile</a></li>
                    </ul>
                   
                </div>
            </header>
            <div>
                <hr class="bar">
            </div>
            <div class="content1">
                <div class="post-read">

                </div>
                <a id="like"  style="color: darkcyan; text-decoration: none;" href="#"><strong class="like"style="position:relative;top:8px;"></strong> 
                    <i class="fa fa-thumbs-up" style="font-size:36px"></i></a>
                
                <div class="addcomments" style="padding-bottom: 3%;margin: auto;">
                  <a href="#" id="submit1" style="text-decoration: none; margin-top: 1%;" onclick="deletepost()">Delete</a>
                    
                </div>
                
                
            </div>
        </div>
       
        <script>
            //Read one post
           const postRead = document.querySelector('.post-read');
      const commentsContainer = document.querySelector('.comments-container');
      const subInput = document.querySelector('.email-input');
      const postId = location.href.split('?id=')[1];

      (async () => {
        const res = await fetch(
          `http://localhost:3000/post1/${postId}`,
        );
        const postData = await res.json();
        const post = postData.data;
        post.views += 1;

        let html = `
                <h2 class="title onRead-title">
                  ${post.title}
                </h2>
                <div class="onRead-post">
                  <p>
                    ${post.content}
                  </p>
                </div>
                `;
        document.querySelector('.like').textContent = post.likes;
        postRead.innerHTML = html;
      })();
      function deletepost(){
         //delete comments
         const confirmation = confirm('Are you sure deleting this post?');
 
         confirmation &&
          (async () => {
            await fetch(
              `http://localhost:3000/dpost/${postId}`,
              {
                method: 'delete',
                headers: { 'content-Type': 'application/json' },
              },
            );
            console.log('deleted successfully');
            location.href = 'admin.html';
          })();
        
      }
      //likes
      const like = document.querySelector('#like');

      like.addEventListener('click', async () => {
        await fetch(
          `http://localhost:3000/like/${postId}`,
          {
            method: 'put',
            headers: { 'content-Type': 'application/json' },
          },
        );
      });
      
        </script>
        <script src="admin.js"></script>
    </body>
</html>
